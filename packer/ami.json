{
    "builders": [
      {
        "type": "amazon-ebs",
        "vpc_filter": {
          "filters": {
            "tag:Name": "jegbu_vpc"
          }
        }, 
        "subnet_filter": {
          "filters": {
            "tag:Name": "Public Subnet AZ1"
          }
        },
        "security_group_filter": {
          "filters": {
            "tag:Name": "Jegbu SG"
          }
        },       
        "region": "us-east-1",
        "shared_credentials_file": "~/.aws/credentials",
        "profile": "default",
        "source_ami_filter": {
          "filters": {
            "virtualization-type": "hvm",
            "name": "ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*",
            "root-device-type": "ebs"
          },
          "owners": ["099720109477"],
          "most_recent": true
        },
        "instance_type": "t2.micro",
        "ssh_username": "ubuntu",
        "ami_name": "ubuntu-ami {{timestamp}}",
        "security_group_id": "sg-0551b6b7b012b6579",
        "associate_public_ip_address": true
      }
    ],
    

    "provisioners": [
      {
          "type": "shell",
          "inline": [
              "sudo apt-get update",
              "sudo apt-get upgrade -y",
              "sudo apt-get dist-upgrade -y",
              "sudo apt-get autoremove -y",
              "sudo apt-get install -y httpd",
              "sudo systemctl enable httpd",
              "sudo systemctl start httpd"
          ]
      },
      {
        "type": "shell",
        "inline": [
            "sleep 30",
            "sudo shutdown -h now"
        ]
    }
  ]
}